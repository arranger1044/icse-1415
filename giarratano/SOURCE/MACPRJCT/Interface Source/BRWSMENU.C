   /*******************************************************/   /*      "C" Language Integrated Production System      */   /*                                                     */   /*            Macintosh Version 3.2  05/12/93          */   /*                                                     */   /*             MACINTOSH BROWSE MENU MODULE            */   /*******************************************************//*************************************************************//* Purpose:                                                  *//*                                                           *//* Principal Programmer(s):                                  *//*      Gary D. Riley                                        *//*                                                           *//* Contributing Programmer(s):                               *//*                                                           *//* Revision History:                                         *//*                                                           *//*************************************************************/#define _BRWSMENU_SOURCE_#include "setup.h"#include <string.h>#include <Menus.h>#if MAC_MPW || MAC_MCW#include <strings.h>#else#include <pascal.h>#endif#if MAC_SC7 || MAC_SC8#define PTOCSTR P2CStr#define CTOPSTR C2PStr#else#define PTOCSTR p2cstr#define CTOPSTR c2pstr#endif#include "moduldef.h"#include "filecom.h"#include "engine.h"#include "commline.h"#include "agenda.h"#include "factmngr.h"#include "ruledef.h"#include "dffctdef.h"#include "tmpltdef.h"#include "globldef.h"#include "dffnxfun.h"#include "genrccom.h"#include "classcom.h"#include "defins.h"#include "apprsrcs.h"#include "interface.h"#include "brwsmenu.h"/***************************************//* LOCAL INTERNAL FUNCTION DEFINITIONS *//***************************************/   static void                    UpdateModuleMenu(void);   /***********************************************//* UpdateBrowseMenu: Updates the Browse menu.  *//***********************************************/void UpdateBrowseMenu()  {   UpdateModuleMenu();   #if ! RUN_TIME   if (EvaluatingTopLevelCommand || BatchActive()) return;#else   if (BatchActive()) return;#endif     #if DEFRULE_CONSTRUCT   if (GetNextDefrule(NULL) != NULL)     { EnableItem(BrowseMenu,DefruleManagerItem); }   if (GetNextActivation(NULL) != NULL)     { EnableItem(BrowseMenu,AgendaManagerItem); }#endif#if DEFFACTS_CONSTRUCT   if (GetNextDeffacts(NULL) != NULL)     { EnableItem(BrowseMenu,DeffactsManagerItem); }#endif#if DEFTEMPLATE_CONSTRUCT   if (GetNextDeftemplate(NULL) != NULL)     { EnableItem(BrowseMenu,DeftemplateManagerItem); }#endif#if DEFFUNCTION_CONSTRUCT   if (GetNextDeffunction(NULL) != NULL)     { EnableItem(BrowseMenu,DeffunctionManagerItem); }#endif#if DEFGLOBAL_CONSTRUCT   if (GetNextDefglobal(NULL) != NULL)     { EnableItem(BrowseMenu,DefglobalManagerItem); }#endif#if DEFGENERIC_CONSTRUCT   if (GetNextDefgeneric(NULL) != NULL)     { EnableItem(BrowseMenu,DefgenericManagerItem); }#endif#if OBJECT_SYSTEM#if DEFINSTANCES_CONSTRUCT   if (GetNextDefinstances(NULL) != NULL)     { EnableItem(BrowseMenu,DefinstancesManagerItem); }#endif   if (GetNextDefclass(NULL) != NULL)     { EnableItem(BrowseMenu,DefclassManagerItem); }#endif  }/**********************************************//* UpdateModuleMenu: Updates the module menu. *//**********************************************/static void UpdateModuleMenu()  {   Str255 moduleTitle;   int position;   struct defmodule *theModule;      EnableItem(BrowseMenu,ModuleItem);      while (CountMItems(ModuleMenu))     { DelMenuItem(ModuleMenu,1); }        for (theModule = GetNextDefmodule(NULL), position = 1;        theModule != NULL;        theModule = GetNextDefmodule(theModule), position++)     {      strncpy((char *) moduleTitle,GetDefmoduleName(theModule),255);      moduleTitle[255] = '\0';      CTOPSTR((char *) moduleTitle);      InsMenuItem(ModuleMenu,moduleTitle,position);      if (theModule == ((struct defmodule *) GetCurrentModule())) CheckItem(ModuleMenu,position,TRUE);     }  }     